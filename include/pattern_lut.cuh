#pragma once

/*
 * Precomputed lookup table for 8-bit sparsity patterns
 * 
 * For each of 256 possible patterns (0x00 to 0xFF):
 *   - count: number of set bits (__popc equivalent)
 *   - offsets[8]: indices of set bits (0-7)
 * 
 * Generated by scripts/generate_pattern_lut.py
 */

struct PatternLUT {
    uint8_t count;
    uint8_t offsets[8];
};

// Constant memory for fast access (1.25 KB)
__device__ __constant__ PatternLUT PATTERN_LUT_BK8[256] = {
    {0, {0, 0, 0, 0, 0, 0, 0, 0}},  // 0x00
    {1, {0, 0, 0, 0, 0, 0, 0, 0}},
    {1, {1, 0, 0, 0, 0, 0, 0, 0}},
    {2, {0, 1, 0, 0, 0, 0, 0, 0}},
    {1, {2, 0, 0, 0, 0, 0, 0, 0}},
    {2, {0, 2, 0, 0, 0, 0, 0, 0}},
    {2, {1, 2, 0, 0, 0, 0, 0, 0}},
    {3, {0, 1, 2, 0, 0, 0, 0, 0}},
    {1, {3, 0, 0, 0, 0, 0, 0, 0}},
    {2, {0, 3, 0, 0, 0, 0, 0, 0}},
    {2, {1, 3, 0, 0, 0, 0, 0, 0}},
    {3, {0, 1, 3, 0, 0, 0, 0, 0}},
    {2, {2, 3, 0, 0, 0, 0, 0, 0}},
    {3, {0, 2, 3, 0, 0, 0, 0, 0}},
    {3, {1, 2, 3, 0, 0, 0, 0, 0}},
    {4, {0, 1, 2, 3, 0, 0, 0, 0}},
    {1, {4, 0, 0, 0, 0, 0, 0, 0}},  // 0x10
    {2, {0, 4, 0, 0, 0, 0, 0, 0}},
    {2, {1, 4, 0, 0, 0, 0, 0, 0}},
    {3, {0, 1, 4, 0, 0, 0, 0, 0}},
    {2, {2, 4, 0, 0, 0, 0, 0, 0}},
    {3, {0, 2, 4, 0, 0, 0, 0, 0}},
    {3, {1, 2, 4, 0, 0, 0, 0, 0}},
    {4, {0, 1, 2, 4, 0, 0, 0, 0}},
    {2, {3, 4, 0, 0, 0, 0, 0, 0}},
    {3, {0, 3, 4, 0, 0, 0, 0, 0}},
    {3, {1, 3, 4, 0, 0, 0, 0, 0}},
    {4, {0, 1, 3, 4, 0, 0, 0, 0}},
    {3, {2, 3, 4, 0, 0, 0, 0, 0}},
    {4, {0, 2, 3, 4, 0, 0, 0, 0}},
    {4, {1, 2, 3, 4, 0, 0, 0, 0}},
    {5, {0, 1, 2, 3, 4, 0, 0, 0}},
    {1, {5, 0, 0, 0, 0, 0, 0, 0}},  // 0x20
    {2, {0, 5, 0, 0, 0, 0, 0, 0}},
    {2, {1, 5, 0, 0, 0, 0, 0, 0}},
    {3, {0, 1, 5, 0, 0, 0, 0, 0}},
    {2, {2, 5, 0, 0, 0, 0, 0, 0}},
    {3, {0, 2, 5, 0, 0, 0, 0, 0}},
    {3, {1, 2, 5, 0, 0, 0, 0, 0}},
    {4, {0, 1, 2, 5, 0, 0, 0, 0}},
    {2, {3, 5, 0, 0, 0, 0, 0, 0}},
    {3, {0, 3, 5, 0, 0, 0, 0, 0}},
    {3, {1, 3, 5, 0, 0, 0, 0, 0}},
    {4, {0, 1, 3, 5, 0, 0, 0, 0}},
    {3, {2, 3, 5, 0, 0, 0, 0, 0}},
    {4, {0, 2, 3, 5, 0, 0, 0, 0}},
    {4, {1, 2, 3, 5, 0, 0, 0, 0}},
    {5, {0, 1, 2, 3, 5, 0, 0, 0}},
    {2, {4, 5, 0, 0, 0, 0, 0, 0}},  // 0x30
    {3, {0, 4, 5, 0, 0, 0, 0, 0}},
    {3, {1, 4, 5, 0, 0, 0, 0, 0}},
    {4, {0, 1, 4, 5, 0, 0, 0, 0}},
    {3, {2, 4, 5, 0, 0, 0, 0, 0}},
    {4, {0, 2, 4, 5, 0, 0, 0, 0}},
    {4, {1, 2, 4, 5, 0, 0, 0, 0}},
    {5, {0, 1, 2, 4, 5, 0, 0, 0}},
    {3, {3, 4, 5, 0, 0, 0, 0, 0}},
    {4, {0, 3, 4, 5, 0, 0, 0, 0}},
    {4, {1, 3, 4, 5, 0, 0, 0, 0}},
    {5, {0, 1, 3, 4, 5, 0, 0, 0}},
    {4, {2, 3, 4, 5, 0, 0, 0, 0}},
    {5, {0, 2, 3, 4, 5, 0, 0, 0}},
    {5, {1, 2, 3, 4, 5, 0, 0, 0}},
    {6, {0, 1, 2, 3, 4, 5, 0, 0}},
    {1, {6, 0, 0, 0, 0, 0, 0, 0}},  // 0x40
    {2, {0, 6, 0, 0, 0, 0, 0, 0}},
    {2, {1, 6, 0, 0, 0, 0, 0, 0}},
    {3, {0, 1, 6, 0, 0, 0, 0, 0}},
    {2, {2, 6, 0, 0, 0, 0, 0, 0}},
    {3, {0, 2, 6, 0, 0, 0, 0, 0}},
    {3, {1, 2, 6, 0, 0, 0, 0, 0}},
    {4, {0, 1, 2, 6, 0, 0, 0, 0}},
    {2, {3, 6, 0, 0, 0, 0, 0, 0}},
    {3, {0, 3, 6, 0, 0, 0, 0, 0}},
    {3, {1, 3, 6, 0, 0, 0, 0, 0}},
    {4, {0, 1, 3, 6, 0, 0, 0, 0}},
    {3, {2, 3, 6, 0, 0, 0, 0, 0}},
    {4, {0, 2, 3, 6, 0, 0, 0, 0}},
    {4, {1, 2, 3, 6, 0, 0, 0, 0}},
    {5, {0, 1, 2, 3, 6, 0, 0, 0}},
    {2, {4, 6, 0, 0, 0, 0, 0, 0}},  // 0x50
    {3, {0, 4, 6, 0, 0, 0, 0, 0}},
    {3, {1, 4, 6, 0, 0, 0, 0, 0}},
    {4, {0, 1, 4, 6, 0, 0, 0, 0}},
    {3, {2, 4, 6, 0, 0, 0, 0, 0}},
    {4, {0, 2, 4, 6, 0, 0, 0, 0}},
    {4, {1, 2, 4, 6, 0, 0, 0, 0}},
    {5, {0, 1, 2, 4, 6, 0, 0, 0}},
    {3, {3, 4, 6, 0, 0, 0, 0, 0}},
    {4, {0, 3, 4, 6, 0, 0, 0, 0}},
    {4, {1, 3, 4, 6, 0, 0, 0, 0}},
    {5, {0, 1, 3, 4, 6, 0, 0, 0}},
    {4, {2, 3, 4, 6, 0, 0, 0, 0}},
    {5, {0, 2, 3, 4, 6, 0, 0, 0}},
    {5, {1, 2, 3, 4, 6, 0, 0, 0}},
    {6, {0, 1, 2, 3, 4, 6, 0, 0}},
    {2, {5, 6, 0, 0, 0, 0, 0, 0}},  // 0x60
    {3, {0, 5, 6, 0, 0, 0, 0, 0}},
    {3, {1, 5, 6, 0, 0, 0, 0, 0}},
    {4, {0, 1, 5, 6, 0, 0, 0, 0}},
    {3, {2, 5, 6, 0, 0, 0, 0, 0}},
    {4, {0, 2, 5, 6, 0, 0, 0, 0}},
    {4, {1, 2, 5, 6, 0, 0, 0, 0}},
    {5, {0, 1, 2, 5, 6, 0, 0, 0}},
    {3, {3, 5, 6, 0, 0, 0, 0, 0}},
    {4, {0, 3, 5, 6, 0, 0, 0, 0}},
    {4, {1, 3, 5, 6, 0, 0, 0, 0}},
    {5, {0, 1, 3, 5, 6, 0, 0, 0}},
    {4, {2, 3, 5, 6, 0, 0, 0, 0}},
    {5, {0, 2, 3, 5, 6, 0, 0, 0}},
    {5, {1, 2, 3, 5, 6, 0, 0, 0}},
    {6, {0, 1, 2, 3, 5, 6, 0, 0}},
    {3, {4, 5, 6, 0, 0, 0, 0, 0}},  // 0x70
    {4, {0, 4, 5, 6, 0, 0, 0, 0}},
    {4, {1, 4, 5, 6, 0, 0, 0, 0}},
    {5, {0, 1, 4, 5, 6, 0, 0, 0}},
    {4, {2, 4, 5, 6, 0, 0, 0, 0}},
    {5, {0, 2, 4, 5, 6, 0, 0, 0}},
    {5, {1, 2, 4, 5, 6, 0, 0, 0}},
    {6, {0, 1, 2, 4, 5, 6, 0, 0}},
    {4, {3, 4, 5, 6, 0, 0, 0, 0}},
    {5, {0, 3, 4, 5, 6, 0, 0, 0}},
    {5, {1, 3, 4, 5, 6, 0, 0, 0}},
    {6, {0, 1, 3, 4, 5, 6, 0, 0}},
    {5, {2, 3, 4, 5, 6, 0, 0, 0}},
    {6, {0, 2, 3, 4, 5, 6, 0, 0}},
    {6, {1, 2, 3, 4, 5, 6, 0, 0}},
    {7, {0, 1, 2, 3, 4, 5, 6, 0}},
    {1, {7, 0, 0, 0, 0, 0, 0, 0}},  // 0x80
    {2, {0, 7, 0, 0, 0, 0, 0, 0}},
    {2, {1, 7, 0, 0, 0, 0, 0, 0}},
    {3, {0, 1, 7, 0, 0, 0, 0, 0}},
    {2, {2, 7, 0, 0, 0, 0, 0, 0}},
    {3, {0, 2, 7, 0, 0, 0, 0, 0}},
    {3, {1, 2, 7, 0, 0, 0, 0, 0}},
    {4, {0, 1, 2, 7, 0, 0, 0, 0}},
    {2, {3, 7, 0, 0, 0, 0, 0, 0}},
    {3, {0, 3, 7, 0, 0, 0, 0, 0}},
    {3, {1, 3, 7, 0, 0, 0, 0, 0}},
    {4, {0, 1, 3, 7, 0, 0, 0, 0}},
    {3, {2, 3, 7, 0, 0, 0, 0, 0}},
    {4, {0, 2, 3, 7, 0, 0, 0, 0}},
    {4, {1, 2, 3, 7, 0, 0, 0, 0}},
    {5, {0, 1, 2, 3, 7, 0, 0, 0}},
    {2, {4, 7, 0, 0, 0, 0, 0, 0}},  // 0x90
    {3, {0, 4, 7, 0, 0, 0, 0, 0}},
    {3, {1, 4, 7, 0, 0, 0, 0, 0}},
    {4, {0, 1, 4, 7, 0, 0, 0, 0}},
    {3, {2, 4, 7, 0, 0, 0, 0, 0}},
    {4, {0, 2, 4, 7, 0, 0, 0, 0}},
    {4, {1, 2, 4, 7, 0, 0, 0, 0}},
    {5, {0, 1, 2, 4, 7, 0, 0, 0}},
    {3, {3, 4, 7, 0, 0, 0, 0, 0}},
    {4, {0, 3, 4, 7, 0, 0, 0, 0}},
    {4, {1, 3, 4, 7, 0, 0, 0, 0}},
    {5, {0, 1, 3, 4, 7, 0, 0, 0}},
    {4, {2, 3, 4, 7, 0, 0, 0, 0}},
    {5, {0, 2, 3, 4, 7, 0, 0, 0}},
    {5, {1, 2, 3, 4, 7, 0, 0, 0}},
    {6, {0, 1, 2, 3, 4, 7, 0, 0}},
    {2, {5, 7, 0, 0, 0, 0, 0, 0}},  // 0xA0
    {3, {0, 5, 7, 0, 0, 0, 0, 0}},
    {3, {1, 5, 7, 0, 0, 0, 0, 0}},
    {4, {0, 1, 5, 7, 0, 0, 0, 0}},
    {3, {2, 5, 7, 0, 0, 0, 0, 0}},
    {4, {0, 2, 5, 7, 0, 0, 0, 0}},
    {4, {1, 2, 5, 7, 0, 0, 0, 0}},
    {5, {0, 1, 2, 5, 7, 0, 0, 0}},
    {3, {3, 5, 7, 0, 0, 0, 0, 0}},
    {4, {0, 3, 5, 7, 0, 0, 0, 0}},
    {4, {1, 3, 5, 7, 0, 0, 0, 0}},
    {5, {0, 1, 3, 5, 7, 0, 0, 0}},
    {4, {2, 3, 5, 7, 0, 0, 0, 0}},
    {5, {0, 2, 3, 5, 7, 0, 0, 0}},
    {5, {1, 2, 3, 5, 7, 0, 0, 0}},
    {6, {0, 1, 2, 3, 5, 7, 0, 0}},
    {3, {4, 5, 7, 0, 0, 0, 0, 0}},  // 0xB0
    {4, {0, 4, 5, 7, 0, 0, 0, 0}},
    {4, {1, 4, 5, 7, 0, 0, 0, 0}},
    {5, {0, 1, 4, 5, 7, 0, 0, 0}},
    {4, {2, 4, 5, 7, 0, 0, 0, 0}},
    {5, {0, 2, 4, 5, 7, 0, 0, 0}},
    {5, {1, 2, 4, 5, 7, 0, 0, 0}},
    {6, {0, 1, 2, 4, 5, 7, 0, 0}},
    {4, {3, 4, 5, 7, 0, 0, 0, 0}},
    {5, {0, 3, 4, 5, 7, 0, 0, 0}},
    {5, {1, 3, 4, 5, 7, 0, 0, 0}},
    {6, {0, 1, 3, 4, 5, 7, 0, 0}},
    {5, {2, 3, 4, 5, 7, 0, 0, 0}},
    {6, {0, 2, 3, 4, 5, 7, 0, 0}},
    {6, {1, 2, 3, 4, 5, 7, 0, 0}},
    {7, {0, 1, 2, 3, 4, 5, 7, 0}},
    {2, {6, 7, 0, 0, 0, 0, 0, 0}},  // 0xC0
    {3, {0, 6, 7, 0, 0, 0, 0, 0}},
    {3, {1, 6, 7, 0, 0, 0, 0, 0}},
    {4, {0, 1, 6, 7, 0, 0, 0, 0}},
    {3, {2, 6, 7, 0, 0, 0, 0, 0}},
    {4, {0, 2, 6, 7, 0, 0, 0, 0}},
    {4, {1, 2, 6, 7, 0, 0, 0, 0}},
    {5, {0, 1, 2, 6, 7, 0, 0, 0}},
    {3, {3, 6, 7, 0, 0, 0, 0, 0}},
    {4, {0, 3, 6, 7, 0, 0, 0, 0}},
    {4, {1, 3, 6, 7, 0, 0, 0, 0}},
    {5, {0, 1, 3, 6, 7, 0, 0, 0}},
    {4, {2, 3, 6, 7, 0, 0, 0, 0}},
    {5, {0, 2, 3, 6, 7, 0, 0, 0}},
    {5, {1, 2, 3, 6, 7, 0, 0, 0}},
    {6, {0, 1, 2, 3, 6, 7, 0, 0}},
    {3, {4, 6, 7, 0, 0, 0, 0, 0}},  // 0xD0
    {4, {0, 4, 6, 7, 0, 0, 0, 0}},
    {4, {1, 4, 6, 7, 0, 0, 0, 0}},
    {5, {0, 1, 4, 6, 7, 0, 0, 0}},
    {4, {2, 4, 6, 7, 0, 0, 0, 0}},
    {5, {0, 2, 4, 6, 7, 0, 0, 0}},
    {5, {1, 2, 4, 6, 7, 0, 0, 0}},
    {6, {0, 1, 2, 4, 6, 7, 0, 0}},
    {4, {3, 4, 6, 7, 0, 0, 0, 0}},
    {5, {0, 3, 4, 6, 7, 0, 0, 0}},
    {5, {1, 3, 4, 6, 7, 0, 0, 0}},
    {6, {0, 1, 3, 4, 6, 7, 0, 0}},
    {5, {2, 3, 4, 6, 7, 0, 0, 0}},
    {6, {0, 2, 3, 4, 6, 7, 0, 0}},
    {6, {1, 2, 3, 4, 6, 7, 0, 0}},
    {7, {0, 1, 2, 3, 4, 6, 7, 0}},
    {3, {5, 6, 7, 0, 0, 0, 0, 0}},  // 0xE0
    {4, {0, 5, 6, 7, 0, 0, 0, 0}},
    {4, {1, 5, 6, 7, 0, 0, 0, 0}},
    {5, {0, 1, 5, 6, 7, 0, 0, 0}},
    {4, {2, 5, 6, 7, 0, 0, 0, 0}},
    {5, {0, 2, 5, 6, 7, 0, 0, 0}},
    {5, {1, 2, 5, 6, 7, 0, 0, 0}},
    {6, {0, 1, 2, 5, 6, 7, 0, 0}},
    {4, {3, 5, 6, 7, 0, 0, 0, 0}},
    {5, {0, 3, 5, 6, 7, 0, 0, 0}},
    {5, {1, 3, 5, 6, 7, 0, 0, 0}},
    {6, {0, 1, 3, 5, 6, 7, 0, 0}},
    {5, {2, 3, 5, 6, 7, 0, 0, 0}},
    {6, {0, 2, 3, 5, 6, 7, 0, 0}},
    {6, {1, 2, 3, 5, 6, 7, 0, 0}},
    {7, {0, 1, 2, 3, 5, 6, 7, 0}},
    {4, {4, 5, 6, 7, 0, 0, 0, 0}},  // 0xF0
    {5, {0, 4, 5, 6, 7, 0, 0, 0}},
    {5, {1, 4, 5, 6, 7, 0, 0, 0}},
    {6, {0, 1, 4, 5, 6, 7, 0, 0}},
    {5, {2, 4, 5, 6, 7, 0, 0, 0}},
    {6, {0, 2, 4, 5, 6, 7, 0, 0}},
    {6, {1, 2, 4, 5, 6, 7, 0, 0}},
    {7, {0, 1, 2, 4, 5, 6, 7, 0}},
    {5, {3, 4, 5, 6, 7, 0, 0, 0}},
    {6, {0, 3, 4, 5, 6, 7, 0, 0}},
    {6, {1, 3, 4, 5, 6, 7, 0, 0}},
    {7, {0, 1, 3, 4, 5, 6, 7, 0}},
    {6, {2, 3, 4, 5, 6, 7, 0, 0}},
    {7, {0, 2, 3, 4, 5, 6, 7, 0}},
    {7, {1, 2, 3, 4, 5, 6, 7, 0}},
    {8, {0, 1, 2, 3, 4, 5, 6, 7}}
};
