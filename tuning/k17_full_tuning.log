============================================================
K17 (esmm_hybrid_blockwise) Kernel Autotuning for A10G
============================================================

============================================================
Tuning K17 (esmm_hybrid_blockwise) for 512x512x512
============================================================
Generated 1024 block patterns
Pattern statistics: min=255, max=255, mean=255.00
Using: NVIDIA A10G
Searchspace has 27 configurations after restrictions.
best performing configuration:
NUM_THREADS=128, BM=64, BN=64, BK=8, TM=1, TN=8, WM=32, WN=32, WNITER=1, time=0.026ms

============================================================
BEST CONFIGURATION FOUND:
============================================================
Time: 0.026 ms
Sparse GFLOPS: 10347.79
Dense GFLOPS: 10347.79
Sparsity: 0.0%
Config: {'NUM_THREADS': 128, 'BM': 64, 'BN': 64, 'BK': 8, 'TM': 1, 'TN': 8, 'WM': 32, 'WN': 32, 'WNITER': 1, 'time': 0.025941333423058193, 'times': [0.03276799991726875, 0.023552000522613525, 0.021503999829292297], 'compile_time': 0, 'verification_time': 0, 'benchmark_time': 0, 'strategy_time': 0, 'framework_time': 4.6231609999267675, 'timestamp': '2025-11-11 22:41:37.261076+00:00'}
============================================================

============================================================
Tuning K17 (esmm_hybrid_blockwise) for 1024x1024x1024
============================================================
Generated 4096 block patterns
Pattern statistics: min=255, max=255, mean=255.00
Using: NVIDIA A10G
Searchspace has 27 configurations after restrictions.
WARNING: Verification failed - max diff: 157.518616
WARNING: Verification failed - max diff: 157.518616
NUM_THREADS=128, BM=64, BN=128, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=2, time=0.043ms
WARNING: Verification failed - max diff: 157.518616
NUM_THREADS=128, BM=64, BN=128, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=4, time=0.046ms
WARNING: Verification failed - max diff: 157.518616
NUM_THREADS=128, BM=64, BN=128, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=8, time=0.052ms
WARNING: Verification failed - max diff: 157.518616
NUM_THREADS=128, BM=128, BN=64, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=1, time=0.044ms
WARNING: Verification failed - max diff: 157.518616
NUM_THREADS=128, BM=128, BN=64, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=2, time=0.044ms
WARNING: Verification failed - max diff: 157.518616
NUM_THREADS=128, BM=128, BN=64, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=4, time=0.044ms
WARNING: Verification failed - max diff: 157.518616
NUM_THREADS=128, BM=128, BN=64, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=8, time=0.045ms
WARNING: Verification failed - max diff: 157.518616
NUM_THREADS=128, BM=128, BN=64, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=1, time=0.044ms
WARNING: Verification failed - max diff: 157.518616
NUM_THREADS=128, BM=128, BN=64, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=2, time=0.049ms
WARNING: Verification failed - max diff: 157.518616
NUM_THREADS=128, BM=128, BN=64, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=4, time=0.045ms
WARNING: Verification failed - max diff: 157.518616
NUM_THREADS=128, BM=128, BN=64, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=8, time=0.045ms
WARNING: Verification failed - max diff: 157.518616
NUM_THREADS=256, BM=128, BN=128, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=1, time=0.055ms
WARNING: Verification failed - max diff: 157.518616
NUM_THREADS=256, BM=128, BN=128, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=2, time=0.047ms
WARNING: Verification failed - max diff: 157.518616
NUM_THREADS=256, BM=128, BN=128, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=4, time=0.048ms
WARNING: Verification failed - max diff: 157.518616
NUM_THREADS=256, BM=128, BN=128, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=8, time=0.068ms
WARNING: Verification failed - max diff: 157.518616
NUM_THREADS=256, BM=128, BN=128, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=1, time=0.045ms
WARNING: Verification failed - max diff: 157.518616
NUM_THREADS=256, BM=128, BN=128, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=2, time=0.050ms
WARNING: Verification failed - max diff: 157.518616
NUM_THREADS=256, BM=128, BN=128, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=4, time=0.055ms
WARNING: Verification failed - max diff: 157.518616
NUM_THREADS=256, BM=128, BN=128, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=8, time=0.049ms
best performing configuration:
NUM_THREADS=128, BM=64, BN=128, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=2, time=0.043ms

============================================================
BEST CONFIGURATION FOUND:
============================================================
Time: 0.043 ms
Sparse GFLOPS: 50306.49
Dense GFLOPS: 50306.49
Sparsity: 0.0%
Config: {'NUM_THREADS': 128, 'BM': 64, 'BN': 128, 'BK': 8, 'TM': 1, 'TN': 8, 'WM': 64, 'WN': 32, 'WNITER': 2, 'time': np.float64(0.042688000947237015), 'times': [0.07072000205516815, 0.02969600073993206, 0.027648000046610832], 'compile_time': 432.55570999997417, 'verification_time': 16.194064000046637, 'benchmark_time': 0.4746879999402154, 'strategy_time': 0, 'framework_time': 0, 'timestamp': '2025-11-11 22:41:45.593881+00:00'}
============================================================

============================================================
Tuning K17 (esmm_hybrid_blockwise) for 2048x2048x2048
============================================================
Generated 16384 block patterns
Pattern statistics: min=255, max=255, mean=255.00
Using: NVIDIA A10G
Searchspace has 27 configurations after restrictions.
WARNING: Verification failed - max diff: 252.892365
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=128, BM=64, BN=64, BK=8, TM=1, TN=8, WM=32, WN=32, WNITER=1, time=0.056ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=128, BM=64, BN=64, BK=8, TM=1, TN=8, WM=32, WN=32, WNITER=2, time=0.057ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=128, BM=64, BN=64, BK=8, TM=1, TN=8, WM=32, WN=32, WNITER=4, time=0.057ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=128, BM=64, BN=128, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=1, time=0.057ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=128, BM=64, BN=128, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=2, time=0.056ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=128, BM=64, BN=128, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=4, time=0.058ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=128, BM=64, BN=128, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=8, time=0.058ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=128, BM=64, BN=128, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=1, time=0.069ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=128, BM=64, BN=128, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=2, time=0.055ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=128, BM=64, BN=128, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=4, time=0.060ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=128, BM=64, BN=128, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=8, time=0.057ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=128, BM=128, BN=64, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=1, time=0.057ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=128, BM=128, BN=64, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=2, time=0.056ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=128, BM=128, BN=64, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=4, time=0.058ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=128, BM=128, BN=64, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=8, time=0.067ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=128, BM=128, BN=64, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=1, time=0.071ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=128, BM=128, BN=64, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=2, time=0.057ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=128, BM=128, BN=64, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=4, time=0.058ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=128, BM=128, BN=64, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=8, time=0.060ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=256, BM=128, BN=128, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=1, time=0.059ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=256, BM=128, BN=128, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=2, time=0.063ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=256, BM=128, BN=128, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=4, time=0.060ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=256, BM=128, BN=128, BK=8, TM=1, TN=8, WM=32, WN=64, WNITER=8, time=0.062ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=256, BM=128, BN=128, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=1, time=0.060ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=256, BM=128, BN=128, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=2, time=0.060ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=256, BM=128, BN=128, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=4, time=0.062ms
WARNING: Verification failed - max diff: 252.892365
NUM_THREADS=256, BM=128, BN=128, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=8, time=0.058ms
best performing configuration:
NUM_THREADS=128, BM=64, BN=128, BK=8, TM=1, TN=8, WM=64, WN=32, WNITER=2, time=0.055ms

============================================================
BEST CONFIGURATION FOUND:
============================================================
Time: 0.055 ms
Sparse GFLOPS: 310689.19
Dense GFLOPS: 310689.19
Sparsity: 0.0%
Config: {'NUM_THREADS': 128, 'BM': 64, 'BN': 128, 'BK': 8, 'TM': 1, 'TN': 8, 'WM': 64, 'WN': 32, 'WNITER': 2, 'time': np.float64(0.05529599885145823), 'times': [0.08191999793052673, 0.04198399931192398, 0.04198399931192398], 'compile_time': 428.0527150000353, 'verification_time': 82.47197100001813, 'benchmark_time': 0.49028900002667797, 'strategy_time': 0, 'framework_time': 0.439959999880557, 'timestamp': '2025-11-11 22:43:02.912046+00:00'}
============================================================

============================================================
K17 TUNING COMPLETE!
============================================================

Results by matrix size:
------------------------------------------------------------

512x512x512:
  Time: 0.026 ms
  Dense GFLOPS: 10347.79
  Sparse GFLOPS: 10347.79
  Sparsity: 0.0%
  Config: BM=64, BN=64, WM=32, WN=32, WNITER=1, THREADS=128

1024x1024x1024:
  Time: 0.043 ms
  Dense GFLOPS: 50306.49
  Sparse GFLOPS: 50306.49
  Sparsity: 0.0%
  Config: BM=64, BN=128, WM=64, WN=32, WNITER=2, THREADS=128

2048x2048x2048:
  Time: 0.055 ms
  Dense GFLOPS: 310689.19
  Sparse GFLOPS: 310689.19
  Sparsity: 0.0%
  Config: BM=64, BN=128, WM=64, WN=32, WNITER=2, THREADS=128

============================================================
BEST OVERALL CONFIGURATION:
============================================================
Performance: 310689.19 GFLOPS
Matrix Size: 2048x2048x2048
Configuration: {'NUM_THREADS': 128, 'BM': 64, 'BN': 128, 'BK': 8, 'TM': 1, 'TN': 8, 'WM': 64, 'WN': 32, 'WNITER': 2, 'time': np.float64(0.05529599885145823), 'times': [0.08191999793052673, 0.04198399931192398, 0.04198399931192398], 'compile_time': 428.0527150000353, 'verification_time': 82.47197100001813, 'benchmark_time': 0.49028900002667797, 'strategy_time': 0, 'framework_time': 0.439959999880557, 'timestamp': '2025-11-11 22:43:02.912046+00:00'}

Results saved to:
  - tuner_results/k17_results.json
  - tuner_results/k17_analysis.json
